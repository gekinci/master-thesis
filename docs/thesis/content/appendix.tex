\appendix

\chapter{Amalgamation}
\label{ap:amalgamation}
The amalgamation operation for two independent processes are derived as follows:
\begin{multline}
	\operatorname{Pr}(X_1(t+h) = x_1', X_2(t+h) = x_2 \mid X_1(t) = x_1, X_2(t) = x_2) \\
	\begin{split}
	&= \operatorname{Pr}(X_1(t+h) = x_1' \mid X_1(t) = x_1, X_2(t) = x_2) \operatorname{Pr}( X_2(t+h) = x_2 \mid X_1(t) = x_1, X_2(t+h) = x_2) \\
	& = (\delta_{x_1', x_1} + hq^1_{x_1, x_1^\prime} + o(h))(1 + hq^2_{x_2, x_2} + o(h))\\
	& = \delta_{x_1', x_1} + hq^1_{x_1, x_1^\prime} + h\delta_{x_1', x_1}q^2_{x_2, x_2} + o(h)
	\end{split}
	\label{eq:amalg}
\end{multline}



\chapter{Marginalized Likelihood Function for Homogenous Continuous Time Markov Processes}
\label{ap:marg_llh_ctmp}

Let $ X $ be a homogenous CTMP. For convenience, it is assumed to be binary-valued, $ \rchi = \left\lbrace x_{0}, x_{1} \right\rbrace $. The transition intensity matrix can be written in the following form:
\begin{equation}
\textbf{Q} = 
\begin{bmatrix}
-q_{0} & q_{0} \\
q_{1} & -q_{1}
\end{bmatrix}
\end{equation}
where the transition intensities $ q_{0} $ and $ q_{1} $ are gamma-distributed with parameters $ \alpha_{0}$, $ \beta_{0} $ and $ \alpha_{1} $, $ \beta_{1} $, respectively. The marginal likelihood of a sample trajectory $ X^{[0,T]} $ can be written as follows:
\begin{align}
P(X^{[0, T]}) & = \int  P(X^{[0, T]}\mid Q)P(Q) dQ \nonumber\\ 
& = \int_{0}^{\infty} = \prod_{j \neq i}  \exp(-q_{i,j}T[x_{i}])\ q_{i,j}^{M[x_{i},x_{j}]} \frac{\beta_{i,j}^{\alpha_{i,j}}{q_{i,j}^{\alpha_{i,j}-1}}\exp(-\beta_{i,j}q_{i,j})}{\Gamma(\alpha_{i,j})} \ dq_{i,j} \nonumber\\ 
& = \prod_{i\in{0,1}}\int_{0}^{\infty} q_{i}^{M[x_{i}]} \ \exp(-q_{i}T[x_{i}]) \  \frac{\beta_{i}^{\alpha_{i}} \ q_{i}^{\alpha_{i}-1}\ \exp(-\beta_{i}q_{i})}{\Gamma(\alpha_{i})} \ dq_{i} \nonumber\\ 
& = \prod_{i\in{0,1}} \frac{\beta_{i}^{\alpha_{i}}}{\Gamma(\alpha_{i})} \int_{0}^{\infty} q_{i}^{M[x_{i}] + \alpha_{i} -1} \ \exp(-q_{i}(T[x_{i}]+\beta_{i})) \ dq_{i} \label{eq:wolfram_line}\\ 
& = \prod_{i\in{0,1}} \frac{\beta_{i}^{\alpha_{i}}}{\Gamma(\alpha_{i})} \left( -(T[x_{i}]+\beta_{i})^{-M[x_{i}] - \alpha_{i}}\ \Gamma(M[x_{i}] + \alpha_{i}, \ q_{i}(T[x_{i}]+\beta_{i})) \right) \Big|_0^\infty  \nonumber\\ 
& = \prod_{i\in{0,1}} \frac{\beta_{i}^{\alpha_{i}}}{\Gamma(\alpha_{i})} \left( (T[x_{i}]+\beta_{i})^{-M[x_{i}] - \alpha_{i}}\ \Gamma(M[x_{i}] + \alpha_{i}) \right)
\label{eq:Marg_traj}
\end{align}
%where $ T[x_{i}] $, the amount of time spent in state x, $ M[x,x'] $ the number of transitions from state x to x' and  $ M[x] = \sum_{x\neq x'}M[x,x'] $.\\

In \autoref{eq:wolfram_line}, the integral is solved using computer algebra system WolframAlpha as follows:
\begin{align}
\int x^{a} \ \exp(-xb) \ dx = -b^{-a-1} \ \Gamma(a+1, \ bx) + C
\label{eq:integral}
\end{align}

